<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PagoYo â€” Vista Cliente</title>
  <style>
    :root { --teal:#0F766E; --orange:#E67E22; --bg:#F4F6F8; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Arial,sans-serif;background:var(--bg);color:#111;}
    header{background:var(--teal);color:#fff;padding:14px;text-align:center;font-size:20px;font-weight:600;}
    main{max-width:700px;margin:auto;padding:20px;}
    h2{margin:14px 0 6px;color:var(--teal);}
    ul{list-style:none;padding:0;margin:0;}
    li{display:flex;justify-content:space-between;padding:10px 8px;margin-bottom:6px;background:#fff;border-radius:10px;box-shadow:0 1px 4px rgba(0,0,0,.06);}
    .total{display:flex;justify-content:space-between;margin-top:16px;padding:12px;background:#fff;border-radius:10px;font-weight:700;color:#0F766E;}
    .btn{margin-top:20px;display:block;width:100%;background:var(--orange);color:#fff;font-weight:600;padding:14px;border:none;border-radius:12px;font-size:16px;cursor:pointer;}
    .btn:hover{opacity:.95}
    footer{text-align:center;margin-top:20px;}
    a{color:var(--teal);text-decoration:none;font-weight:600}

    /* Modal simple */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;padding:18px;}
    .modal{width:min(520px,92vw);background:#fff;border-radius:14px;box-shadow:0 20px 60px rgba(0,0,0,.25);padding:18px;border:1px solid rgba(15,118,110,.15)}
    .modal h3{margin:0 0 10px;color:#0F766E}
    .options{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    .opt{border:1.5px solid #e5e7eb;border-radius:12px;padding:12px;text-align:center;font-weight:700;cursor:pointer;background:#fafafa}
    .opt:hover{border-color:#0F766E}
    .opt.cash{background:#fff8ee}
    .opt.card{background:#eff6ff}
    .close{margin-top:12px;display:block;width:100%;background:#111;color:#fff;border:none;border-radius:10px;padding:10px;cursor:pointer}

    /* Resumen final */
    .done{display:none;margin-top:16px;padding:14px;background:#ecfdf5;border:1px solid #86efac;border-radius:12px}
    .small{color:#444;font-size:14px;margin-top:6px}
    .ref{font-weight:800;color:#0F766E}
  </style>
</head>
<body>
  <header>Mesa 6 â€” Ticket de ejemplo</header>
  <main>
    <h2>Consumiciones</h2>
    <ul>
      <li><span>3Ã— RaciÃ³n Calamares</span><span>28,50 â‚¬</span></li>
      <li><span>6Ã— Refrescos</span><span>13,20 â‚¬</span></li>
      <li><span>2Ã— RaciÃ³n Patatas</span><span>12,00 â‚¬</span></li>
      <li><span>4Ã— CaÃ±as</span><span>7,20 â‚¬</span></li>
      <li><span>2Ã— Tarta de Queso</span><span>9,00 â‚¬</span></li>
    </ul>
    <div class="total">
      <span>Total Mesa</span><span>69,90 â‚¬</span>
    </div>

    <button id="confirmBtn" class="btn">Confirmar mi parte</button>

    <div id="doneBox" class="done">
      âœ” Tu parte estÃ¡ lista. MÃ©todo: <span id="methodTxt" class="ref">â€”</span><br/>
      <span class="small">EnseÃ±a este cÃ³digo si te lo piden: <span id="refCode" class="ref"></span></span>
    </div>

    <footer><p><a href="../">â¬… Volver al inicio</a></p></footer>
  </main>

  <!-- Modal -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal">
      <h3>Elige mÃ©todo de pago</h3>
      <div class="options">
        <div class="opt cash" data-method="Efectivo">ðŸ’µ Efectivo</div>
        <div class="opt card" data-method="Tarjeta">ðŸ’³ Tarjeta</div>
      </div>
      <button id="closeBtn" class="close">Cancelar</button>
    </div>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    const overlay = $("#overlay");
    const confirmBtn = $("#confirmBtn");
    const closeBtn = $("#closeBtn");
    const doneBox = $("#doneBox");
    const methodTxt = $("#methodTxt");
    const refCode = $("#refCode");

    // Abrir modal
    confirmBtn.addEventListener("click", () => {
      overlay.style.display = "flex";
      overlay.setAttribute("aria-hidden","false");
    });

    // Cerrar modal
    closeBtn.addEventListener("click", () => {
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden","true");
    });
    overlay.addEventListener("click", (e) => {
      if(e.target === overlay) closeBtn.click();
    });

    // Canal de comunicaciÃ³n para la demo (misma tablet, otra pestaÃ±a)
    const ch = new BroadcastChannel('pagoyo_demo');

    // SelecciÃ³n de mÃ©todo
    document.querySelectorAll(".opt").forEach(el=>{
      el.addEventListener("click", ()=>{
        const method = el.getAttribute("data-method");
        const code = "M6-" + Math.random().toString(36).slice(2,6).toUpperCase();

        // Mostrar resumen local
        methodTxt.textContent = method;
        refCode.textContent = code;
        doneBox.style.display = "block";
        confirmBtn.textContent = "Parte confirmada";
        confirmBtn.disabled = true;

        // Cerrar modal
        closeBtn.click();

        // Enviar al Panel Camarero (otra pestaÃ±a)
        ch.postMessage({
          type: 'partial_confirmed',
          method,                       // "Efectivo" o "Tarjeta"
          amount: '18,50 â‚¬',            // Importe de ejemplo
          items: '1Ã— Calamares Â· 2Ã— Refresco',
          code
        });
      });
    });
  </script>
</body>
</html>
